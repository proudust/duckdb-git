# name: test/sql/rusty_quack.test
# description: test git_log extension
# group: [git]

# Before we load the extension, this will fail
statement error
SELECT * FROM git_log('.');
----
Catalog Error: Table Function with name git_log does not exist!

# Require statement will ensure the extension is loaded from now on
require rusty_quack

# Confirm the extension works - test basic git_log functionality
query I
SELECT COUNT(*) FROM git_log('.');
----
(more than 0 rows expected)

# Test that we can access specific columns
query I
SELECT hash, author FROM git_log('.') LIMIT 1;
