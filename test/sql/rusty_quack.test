# name: test/sql/rusty_quack.test
# description: test git_log extension
# group: [git]

# Before we load the extension, this will fail
statement error
SELECT * FROM git_log('.');
----
Catalog Error: Table Function with name git_log does not exist!

# Require statement will ensure the extension is loaded from now on
require rusty_quack

# Confirm the extension works - test basic git_log functionality
query I
SELECT COUNT(*) FROM git_log('.');
----
2

# Test that we can access specific columns
query II
SELECT hash, author FROM git_log('.') ORDER BY timestamp DESC LIMIT 1;
----
2e6d5e79dafd8ff8c09152ac35e32cd26e65efe5	Proudust

# Test that all columns are accessible
statement ok
SELECT hash, author, email, message, timestamp FROM git_log('.') LIMIT 1;
